import{r as a,R as W,s as D}from"./radix-ui-BUWJLcKz.js";function V(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,o,s,r,c=[],f="",l=e.split("/");for(l[0]||l.shift();s=l.shift();)n=s[0],n==="*"?(c.push(n),f+=s[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(o=s.indexOf("?",1),r=s.indexOf(".",1),c.push(s.substring(1,~o?o:~r?r:s.length)),f+=~o&&!~r?"(?:/([^/]+?))?":"/([^/]+?)",~r&&(f+=(~o?"?":"")+"\\"+s.substring(r))):f+="/"+s;return{keys:c,pattern:new RegExp("^"+f+(t?"(?=$|/)":"/?$"),"i")}}const $=W.useInsertionEffect,A=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",B=A?a.useLayoutEffect:a.useEffect,F=$||B,C=e=>{const t=a.useRef([e,(...n)=>t[0](...n)]).current;return F(()=>{t[0]=e}),t[1]},H="popstate",y="pushState",w="replaceState",M="hashchange",v=[H,y,w,M],N=e=>{for(const t of v)addEventListener(t,e);return()=>{for(const t of v)removeEventListener(t,e)}},S=(e,t)=>D.useSyncExternalStore(N,e,t),q=()=>location.search,z=({ssrSearch:e=""}={})=>S(q,()=>e),P=()=>location.pathname,G=({ssrPath:e}={})=>S(P,e?()=>e:P),J=(e,{replace:t=!1,state:n=null}={})=>history[t?w:y](n,"",e),Q=(e={})=>[G(e),J],x=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[x]>"u"){for(const e of[y,w]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),o=new Event(e);return o.arguments=arguments,dispatchEvent(o),n}}Object.defineProperty(window,x,{value:!0})}const X=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",k=(e="")=>e==="/"?"":e,Y=(e,t)=>e[0]==="~"?e.slice(1):k(t)+e,Z=(e="",t)=>X(b(k(e)),b(t)),b=e=>{try{return decodeURI(e)}catch{return e}},L={hook:Q,searchHook:z,parser:V,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},U=a.createContext(L),p=()=>a.useContext(U),T={},j=a.createContext(T),ee=()=>a.useContext(j),m=e=>{const[t,n]=e.hook(e);return[Z(e.base,t),C((o,s)=>n(Y(o,e.base),s))]},oe=()=>m(p()),I=(e,t,n,o)=>{const{pattern:s,keys:r}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",o),c=s.exec(n)||[],[f,...l]=c;return f!==void 0?[!0,(()=>{const u=r!==!1?Object.fromEntries(r.map((d,R)=>[d,l[R]])):c.groups;let i={...l};return u&&Object.assign(i,u),i})(),...o?[f]:[]]:[!1,null]},te=({children:e,...t})=>{const n=p(),o=t.hook?L:n;let s=o;const[r,c]=t.ssrPath?.split("?")??[];c&&(t.ssrSearch=c,t.ssrPath=r),t.hrefs=t.hrefs??t.hook?.hrefs;let f=a.useRef({}),l=f.current,u=l;for(let i in o){const d=i==="base"?o[i]+(t[i]||""):t[i]||o[i];l===u&&d!==u[i]&&(f.current=u={...u}),u[i]=d,(d!==o[i]||d!==s[i])&&(s=u)}return a.createElement(U.Provider,{value:s,children:e})},O=({children:e,component:t},n)=>t?a.createElement(t,{params:n}):typeof e=="function"?e(n):e,ne=e=>{let t=a.useRef(T);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([o,s])=>s!==n[o])?e:n},re=({path:e,nest:t,match:n,...o})=>{const s=p(),[r]=m(s),[c,f,l]=n??I(s.parser,e,r,t),u=ne({...ee(),...f});if(!c)return null;const i=l?a.createElement(te,{base:l},O(o,u)):O(o,u);return a.createElement(j.Provider,{value:u,children:i})};a.forwardRef((e,t)=>{const n=p(),[o,s]=m(n),{to:r="",href:c=r,onClick:f,asChild:l,children:u,className:i,replace:d,state:R,...K}=e,_=C(h=>{h.ctrlKey||h.metaKey||h.altKey||h.shiftKey||h.button!==0||(f?.(h),h.defaultPrevented||(h.preventDefault(),s(c,e)))}),g=n.hrefs(c[0]==="~"?c.slice(1):n.base+c,n);return l&&a.isValidElement(u)?a.cloneElement(u,{onClick:_,href:g}):a.createElement("a",{...K,onClick:_,href:g,className:i?.call?i(o===c):i,children:u,ref:t})});const E=e=>Array.isArray(e)?e.flatMap(t=>E(t&&t.type===a.Fragment?t.props.children:t)):[e],ae=({children:e,location:t})=>{const n=p(),[o]=m(n);typeof window<"u"&&(window.__WOUTER_ROUTES__||(window.__WOUTER_ROUTES__=[]),E(e).forEach(r=>{if(a.isValidElement(r)&&r.props.path){const c=r.props.path;window.__WOUTER_ROUTES__.includes(c)||window.__WOUTER_ROUTES__.push(c)}}));for(const s of E(e)){let r=0;if(a.isValidElement(s)&&(r=I(n.parser,s.props.path,t||o,s.props.nest))[0])return a.cloneElement(s,{match:r})}return null};export{re as R,ae as S,oe as u};
